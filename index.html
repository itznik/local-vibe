<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Local Vibe - Surat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body class="bg-gray-100 font-sans">

    <div class="container mx-auto p-4 md:p-8">
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-indigo-600">Local Vibe</h1>
            <p class="text-gray-600 mt-2">Discover and join spontaneous skill-sharing workshops in Surat!</p>
        </header>

        <main id="workshops-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <p id="loading-message" class="text-gray-500 italic col-span-full text-center">Loading awesome workshops near you...</p>
        </main>
    </div>

    <template id="workshop-card-template">
        <div class="bg-white rounded-xl shadow-lg overflow-hidden transform hover:scale-105 transition-transform duration-300">
            <div class="p-6">
                <div class="flex justify-between items-start">
                    <div>
                        <div class="uppercase tracking-wide text-sm text-indigo-500 font-semibold" data-title></div>
                        <p class="mt-1 text-gray-500 text-sm" data-location></p>
                    </div>
                    <div class="text-right">
                       <p class="text-xl font-bold text-gray-900" data-price></p>
                       <p class="text-xs text-gray-500">per person</p>
                    </div>
                </div>
                <p class="mt-4 text-gray-700" data-description></p>
                <div class="mt-4 flex justify-between items-center text-sm text-gray-600">
                    <div class="flex items-center">
                        <i class="fas fa-user-circle mr-2 text-gray-400"></i>
                        <span data-host></span>
                    </div>
                    <div class="flex items-center">
                         <i class="fas fa-users mr-2 text-gray-400"></i>
                        <span data-spots></span> spots left
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script>
        const API_BASE_URL = 'https://local-vibe-api.onrender.com'; // This MUST be your Render URL
        const workshopsList = document.getElementById('workshops-list');
        const loadingMessage = document.getElementById('loading-message');
        const template = document.getElementById('workshop-card-template');

        async function fetchAndDisplayWorkshops() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/workshops`);
                if (!response.ok) throw new Error('Failed to fetch workshops.');
                const workshops = await response.json();
                
                loadingMessage.remove();

                if (workshops.length === 0) {
                    workshopsList.innerHTML = '<p class="text-gray-500 col-span-full text-center">No workshops posted yet.</p>';
                    return;
                }

                workshops.forEach(workshop => {
                    const card = template.content.cloneNode(true);
                    card.querySelector('[data-title]').textContent = workshop.title;
                    card.querySelector('[data-location]').textContent = workshop.location;
                    card.querySelector('[data-description]').textContent = workshop.description;
                    card.querySelector('[data-host]').textContent = `Hosted by ${workshop.host}`;
                    card.querySelector('[data-spots]').textContent = workshop.spots;
                    card.querySelector('[data-price]').textContent = `â‚¹${workshop.price}`;
                    workshopsList.appendChild(card);
                });

            } catch (error) {
                console.error('Error:', error);
                loadingMessage.textContent = 'Could not load workshops. Please try refreshing.';
                loadingMessage.classList.add('text-red-500');
            }
        }
        fetchAndDisplayWorkshops();
    </script>
</body>
</html>


